CREATE TABLE  DG_ROLE_RIGHTS_USERS_GROUP AS
SELECT A.USER_GROUP_MAP_ID, A.USER_ID,a.APPL_CODE, (SELECT GROUP_NAME FROM SEC_GROUPS WHERE GROUP_CODE = A.GROUP_CODE) "GROUP_CODE",A.STATUS FROM MMSSODB.USER_GROUP_MAP A  
 --a.APPL_CODE = 'LEA' 

SELECT * FROM DG_ROLE_RIGHTS_USERS_GROUP

select * FROM MMSSODB.USER_GROUP_MAP

DROP TABLE DG_ROLE_RIGHTS_USERS

CREATE TABLE  DG_ROLE_RIGHTS_USERS AS
SELECT   DISTINCT C.APPL_CODE,c.APPL_NAME "RIGHTDESC", B.USER_ID,
B.USER_NAME,B.EMPLOYEE_CODE,F.DEPARTMENT_NAME "DEPARTMENT AS PER HR"
,CASE WHEN 
H.LSD_DEPARTMENT_NAME_C IS NOT NULL THEN H.LSD_DEPARTMENT_NAME_C ELSE NULL END "DEPARTMENT AS PER SYSTEM" --yogesh
,F.DESIG_NAME ROLE,F.LOCATION_NAME,G.CITY "CITY AS PER SYSTEM",G.STATE,
CASE WHEN 
c.APPL_NAME='Customer Acquisition System' THEN  d.LSUR_LSR_ROLE_ID_C ELSE 
NULL END "LSUR_LSR_ROLE_ID_C" 
FROM MMSSODB.USER_APPL_MAP A, MMSSODB.SEC_APPL_USERS B,
MMSSODB.SEC_APPLICATIONS C,MMMASDB.LOS_SEC_USER_ROLES D,
MMFADB.PA_VIEW_EMPLOYEE F,MMSSODB.APPL_USERS_INFO G
,MMCASDB.LOS_SEC_USER E,  MMCASDB.LOS_SEC_DEPARTMENT H--for CAS dept yogesh
WHERE 
A.USER_ID(+)=B.USER_ID
AND D.LSUR_LSU_USER_ID_C(+)=B.USER_ID
AND A.APPL_CODE=C.APPL_CODE(+)
AND B.EMPLOYEE_CODE=F.EMPCODE(+)
AND B.USER_ID=G.USER_ID(+)
AND B.STATUS='A'
AND E.LSU_LSD_DEPARTMENT_CODE_C =H.LSD_DEPARTMENT_CODE_C(+)--for CAS dept yogesh
AND b.user_id= E.LSU_USER_ID_C(+)--for CAS dept yogesh



update DG_ROLE_RIGHTS_USERS a set LSUR_LSR_ROLE_ID_C = 
(select GROUP_CODE from DG_ROLE_RIGHTS_USERS_GROUP where USER_ID =a.USER_ID and APPL_CODE =a.APPL_CODE) where APPL_CODE <>'CAS' 



SELECT * FROM DG_ROLE_RIGHTS_USERS A 

SELECT  DGA.GROUP_CODE FROM DG_ROLE_RIGHTS_USERS_GROUP DGA WHERE DGA.APPL_CODE = A.APPL_CODE

SELECT * FROM MMSSODB.USER_APPL_MAP WHERE STATUS = 'A'  

SELECT * FROM MMSSODB.SEC_APPLICATIONS

SELECT B.GROUP_CODE FROM DG_ROLE_RIGHTS_USERS A ,DG_ROLE_RIGHTS_USERS_GROUP B WHERE A.USER_ID=B.USER_ID AND A.APPL_CODE = B.APPL_CODE
and a.APPL_CODE <>'CAS'

SELECT *  FROM DG_ROLE_RIGHTS_USERS where APPL_CODE <>'CAS'

update DG_ROLE_RIGHTS_USERS a set LSUR_LSR_ROLE_ID_C = 
(select GROUP_CODE from DG_ROLE_RIGHTS_USERS_GROUP where USER_ID =a.USER_ID and APPL_CODE =a.APPL_CODE) where APPL_CODE <>'CAS' 


select * from DG_ROLE_RIGHTS_USERS where USER_ID = 'Y7015827'